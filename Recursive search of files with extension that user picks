Imports System.IO
Module Module1
    Sub Main()
        Dim filename, ext As String
        Console.WriteLine("Insert a folder:")
        filename = Console.ReadLine()
        Console.WriteLine("Insert a file extension (in format *.file):")
        ext = Console.ReadLine()
        Research(filename, ext)
        Console.WriteLine("Done!")
        Console.ReadKey()
    End Sub
    Public Sub Research(ByVal sDir As String, ByVal ex As String)
        Dim fl, dr As String
        Try
            For Each fl In Directory.GetFiles(sDir, ex)
                Console.WriteLine(fl)
            Next
            For Each dr In Directory.GetDirectories(sDir)
                Research(dr, ex)
            Next
        Catch e As System.UnauthorizedAccessException
            Console.WriteLine("You don't have permission to access this folder!")
        End Try
    End Sub
End Module
